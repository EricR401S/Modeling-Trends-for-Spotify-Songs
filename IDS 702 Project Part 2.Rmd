---
title: "Part 2 - Statistical Analysis Plan"
author: "Eric Rios, Emma Wang, Pragya Raghuvanshi, Lorna Aine"
date: "2022-11-02"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Part 2: Statistical Analysis Plan

In part 2, you will produce a statistical analysis plan. The plan should be at most 2 pages, produced in R
Markdown, and include the following:
2



• Overview: Briefly describe the dataset and research questions.

The data set used in this research is a subset of a larger [spotify dataset](https://www.kaggle.com/datasets/yamaerenay/spotify-dataset-19212020-600k-tracks) that contained `r format(nrow(df), big.mark = ",")` tracks. Our final subset of the data set of interest to our research problems contains `r format(nrow(subset), big.mark = ",")` of observations/ tracks and `r ncol(subset)` of variables for songs between 2010 and 2019.
Our focus in this research is to infer which features of music are best associated to the popularity of songs and to predict if a song will be explicit or not based on these features. Our Research Questions:

-What are the musical attributes that gauged the popularity of songs in the 2010s? 
*Dependent Variable (continuous) = popularity;*
*Independent Variables = acousticness, danceability, energy, instrumentation, tempo, loudness, and speechiness* 
 
-To what extent can the musicality of a song predict whether a song will be explicit or non-explicit? 
*Dependent Variable (categorical) = Explicitness;*
*Independent Variables = danceability, energy, speechiness, and tempo* 



• Models: Describe the type of model you will use for each research question. Justify your selections.













In research question 2, we ask “To what extent can the musicality of a song predict whether a song will be explicit or non-explicit? (musicality = danceability, energy, speechiness, and tempo)“, Multiple Logistic Regression will be conducted for following reasons:
*1. Our research question includes a response variable that is binary and categorical, namely explicitness and non-explicitness, with multiple predictors.
*2. The goal is to predict the probability that the song belongs to a particular category, namely explicitness or non-explicitness. For this, we will set the cutoff point at 0.5, where everything greater than or equal to this cutoff indicates explicitness, while the rest is non-explicit.

Pre-processing: 

In order to generate the predictive probabilities, we will split our dataset into training set and test test. More specifically, our training set will consist of songs released in 2010-2017 and will contain the data to fit our model, while our test-set, the one for which we will generate predictive probabilities, will be made up of songs between 2018 and 2019. Additionally, we will set the response variable as a factor (explicitness = 1, non-explicitness = 0).


Model-fitting

After the regression model is fit, we will verify if our model's predictors exhibit multi-collinearity. To do this, we will perform a Variable Inflation Factor (VIF) test to see if there is a score higher than 5.0, a sign of strong correlation between predictors. If there is at least one predictor with a score higher than 5, it suggests potential multi-collinearity, and we may consider refitting the regression model without said predictor.

At this stage, we will also look at the binned residuals plot, to verify that the data falls within the band of a 95% confidence interval. If the majority of the points are not contained within those bands, a transformation may be necessary. As for the assumptions, we will asess independence, which appears to already be satisfied, given how the data was collected. Lastly, the difference between the null deviance and residual deviance will also serve as an indicator to assess the overall fit.


Evaluation:

To evaluate our result from logistic regression, we will calculate the accuracy of our predictive probabilities, plot the ROC curve with AUC value. We will then be able to know how well the model predicted the probabilities of explicitness and non-explicitness (1 vs 0) for the out-of-sample, test data (year 2018-2019). After this initial assessment, we will proceed into a k-fold cross-validation stage, where the entirety of the data, segmented into an arbitrary number of groups, will be divided into training and test sets and have a logistic regression model fitted to it at each step, until all the groups of data points have been part of both a training and test set. After the cross-validation is completed, we will finally be able to ascertain the overall success of the model's predictive accuracy, which is a metric gathered from all of the accuracies of the models fitted during the cross-validation test. 



• Variable selection: How will you perform variable selection for your models? For each research question, list any variables that you are selecting a priori to be included in your model.

Note : I am working on truncating and rewriting this part - Eric, still on the first paragraph. I will probably have to restate everything, and she talked about citing, so yes, this is essentially a paraphrase + rewrite.

Our Research Questions:
<ul>
-Q1: What are the musical attributes that gauged the popularity of songs in the 2010s? 
*Dependent Variable (continuous) = popularity;*
*Independent Variables = acousticness, danceability, energy, instrumentation, tempo, loudness, and speechiness* 
 <ul>

Firstly, domain knowledge of musical terminology was helpful in choosing the specific predictors for both research questions. For the first question, we are investigating if the aforementioned musical attributes have a an associative relationship with popularity. Popular songs, whether they are an emotional ballad or a dance track, all have certain features to keep the listeners engaged and interested (Leviatan, 2017). The tempo, energy and loudness indicate the pacing and sonic impact and pleasantness of the track. The speechiness, danceability and instrumentation (which also includes acoustic choices or "acousticness") dictate melody choices, chord progressions, instrument choices, wordings, vocal lines and more types sonic layers. However, the latter is very nuanced because it pertains to the genre choice of the producers. There are very popular songs with high instrumentation, no words and low danceability, such as songs from classical music. On the other hand, Pop and Rock songs vary their levels of instrumentation and acousticness and speechiness. Lastly, if the song is aimed towards a festive audience, such as a club song, then prioritizing danceability governs the levels of instrumentation and speechiness and lack of acousticness, and this prioritization varies by genre (Androids, 2017). In conclusion, the interplay of these factors influences the popularity of songs by making them memorable and enticing. 

Note here : Backwards/Stepwise Selection

-Q2: To what extent can the musicality of a song predict whether a song will be explicit or non-explicit? 
<ul>
*Dependent Variable (categorical) = Explicitness;*
*Independent Variables = danceability, energy, speechiness, and tempo* 
<ul>

As for the second research question, the explicitness of tracks is strongly swayed by other factors. A very logical approach to predicting explicitness was first looking at the high levels of speechiness in songs. For example, rap songs rank high in this metric because the verses are composed of a spoken word format over a series of 8 or 16 bars, and each bar is a rap line (Edwords), while singing doesn't have to adhere to the "1 bar = 1 line" rule; thus, speechiness became the metric of most importance. In addition, songs in this genre tend to include explicit content, often sexual, in the lyrics (Tayag, 2017). Second to this metric, the other predictors of danceability, energy and tempo were considered as helpful in predicting explicitness. The energy and danceability of the song collude with speechiness to infer if a track could have explicit language. For example, a song with low energy and low danceability may or may not be less likely to have explicit language than a song with high energy and danceability, holding the speechiness level constant, and this is a relationship we wish to investigate as well. As for tempo, music genres that are known to include explicit language follow specific tempos. For instance, Trap songs usually have a tempo of 140 bpm (Burchell, 2019).



• Challenges: How do you plan to address the challenges you presented in part 1?

In part I we proposed one limitation that our “explicitness" as a dependent variable does not have even distribution over years. Specifically, songs in 2018 - 2019 years are more often presented in explicit form than non-explicit form, meaning that the training for inexplicit songs could be limited by fewer explicit data points. Thus, one way to decrease the drawback is that when logistic regression is conducted, our train set will only include years from 2010-2017, so that the training process would have less unequal proportion of explicit and inexplicit songs. 

An example of a statistical analysis plan is posted in Lessons on Sakai. The “primary analysis” and “sec-
ondary analysis” sections can serve as guides for how to discuss what kinds of models will be fit and why.