---
title: "Multi Linear Regression-RQ1"
output: html_document
date: "2022-11-11"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#Load Libraries
library(ggplot2)
library(psych)
library(corrplot)
library(dplyr)
library(table1)
library(boot)
```



```{r}

df1 <- read.csv("https://raw.githubusercontent.com/EricR401S/Modeling-Trends-for-Spotify-Songs/part2/archive/rq1.csv")
```





```{r}
library('MASS')

linear1 <- lm(popularity ~ acousticness+danceability+energy+instrumentalness+ tempo+ loudness+speechiness , data = df1)
backward<- stepAIC(linear1, trace=TRUE, direction = 'backward')
summary(backward)
```

```{r}
plot(backward)
```

```{r}
confinterval <- confint(backward, level = 0.95)
confinterval
```

## 1.d. Take On model Assumptions


## 1.d. Interpretation of the regression model

1. Linearity : Residual vs predictor graphh

2. Normal distribution of residuals: Normal Q-Q CURVE 

3. Independence of error term: Residual vs fitted curve

4. homoscedasticity:( Equal variance of error terms) The Scale-Location graphs shows whether residuals are spread equally along the ranges of predictors. Itâ€™s good we see a horizontal line with equally (randomly) spread points. 


```{r}
#Assumptions of model 1
#Linearity residuals vs duration
library(olsrr)
res <- resid(backward)
plot(df1$acousticness,res)
plot(df1$danceability,res)
plot(df1$energy,res)
plot(df1$instrumentalness,res)
plot(df1$tempo,res)
plot(df1$loudness,res)
plot(df1$speechiness,res)
abline(0,0)
#Independence and equal variance of error terms
ols_plot_resid_fit(backward)
#Normality of residuals
ols_plot_resid_qq(backward)
```



```{r}
ols_plot_resid_hist(backward)
```

Outliers and Influential point - Cooks distance
```{r}
ols_plot_cooksd_bar(backward)
```


```{r}
ols_plot_resid_lev(backward)
```

```{r}
ols_plot_resid_lev(backward[])
```



```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
